datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
//  output   = "./prisma/client"
}

model Habitat {
  id             Int              @id @default(autoincrement())
  userId         Int
  name           String
  isMain         Boolean          @default(true)
  buildingZones  BuildingZone[]
  resourceAmount ResourceAmount[]
}

model Building {
  id                            Int                             @id @default(autoincrement())
  name                          String
  role                          Int
  buildingZones                 BuildingZone[]
  buildingDetailsAtCertainLevel BuildingDetailsAtCertainLevel[]
  buildingQueue                 BuildingQueueElement[]
}

model BuildingDetailsAtCertainLevel {
  id                            Int      @id @default(autoincrement())
  building                      Building @relation(fields: [buildingId], references: [id])
  buildingId                    Int
  level                         Int
  timeToUpdateBuildingInSeconds Int
  // requirements                  Json
}

model BuildingZone {
  id                     Int       @id @default(autoincrement())
  habitat                Habitat   @relation(fields: [habitatId], references: [id])
  habitatId              Int
  building               Building? @relation(fields: [buildingId], references: [id])
  buildingId             Int?
  level                  Int       @default(0)
  placement              String?
  counterPerHabitat      Int
  buildingQueue          BuildingQueueElement[]
}

model BuildingQueueElement {
  id                Int       @id @default(autoincrement())
  startLevel        Int
  endLevel          Int
  startTime         DateTime
  endTime           DateTime
  building          Building @relation(fields: [buildingId], references: [id])
  buildingId        Int
  buildingZone      BuildingZone @relation(fields: [buildingZoneId], references: [id])
  buildingZoneId    Int
}

model Resource {
  id       Int              @id @default(autoincrement())
  name     String
  type     Int
  habitats ResourceAmount[]
}

model ResourceAmount {
  habitat    Habitat  @relation(fields: [habitatId], references: [id])
  habitatId  Int
  resource   Resource @relation(fields: [resourceId], references: [id])
  resourceId Int

  @@id([habitatId, resourceId])
}
